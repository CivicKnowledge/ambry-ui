{% extends "layout.html" %}
{% from "macros.html" import json_button%}
{% block title %}{{p.name}}{% endblock %}
{% block head %}
    {{ super() }}
    <link href="{{ url_for('static', filename='css/recline.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='js/bower_components/slickgrid/slick.grid.css') }}" rel="stylesheet">


{% endblock %}
{% block json_button %}
    {{ json_button('partition_json', vid=p.vid) }}
{% endblock %}
{% block masthead %}{{p.vname}}{% endblock %}
{% block pageheader %}
    <div class="row page-header">
        <div class="col-md-7">
            <div class="summary">{{ p.description }}. {{ p.sub_description }}. {{ p.count }} Rows.</div>
            <div>
                {% if b.metadata.about.access == 'public' or current_user.is_authenticated %}
                 <a class="btn btn-primary btn-sm" href="{{url_for('stream_file', pvid=p.vid, ct='csv')}}">CSV</a>
                {% endif %}
                From: <a href="{{url_for('bundle_main',vid=p.dataset.vid)}}">{{p.dataset.fqname}}</a>.
                Table: {{p.table.name}}.

            </div>
        </div>
        <div class="col-md-5">
            <dl class="dl-horizontal">
                <dt>name</dt>
                <dd><input value="{{ p.name }}" class="form-control"></dd>
                <dt>vname</dt>
                <dd><input value="{{ p.vname }}"  class="form-control"></dd>
                <dt>vid</dt>
                <dd><input value="{{ p.vid }}"  class="form-control"></dd>
            </dl>
        </div>
    </div>

{%  endblock %}
{% block page_css %}



{%  endblock %}
{% block body %}
<div id="mygrid" style="height: 400px"></div>

{% endblock %}

{% block tailjs %}
{{ super() }}
    <script language="javascript" type="text/javascript"
            src="{{ url_for('static', filename='js/jquery.event.drag-2.2.js')}}">
    </script>
    <script language="javascript" type="text/javascript"
            src="{{ url_for('static', filename='js/bower_components/underscore/underscore-min.js')}}">
    </script>
    <script language="javascript" type="text/javascript"
            src="{{ url_for('static', filename='js/bower_components/backbone/backbone.js')}}">
    </script>
    <script language="javascript" type="text/javascript"
            src="{{ url_for('static', filename='js/bower_components/mustache.js/mustache.min.js')}}">
    </script>
    <script language="javascript" type="text/javascript"
            src="{{ url_for('static', filename='js/bower_components/slickgrid/slick.core.js')}}">
    </script>
    <script language="javascript" type="text/javascript"
            src="{{ url_for('static', filename='js/bower_components/slickgrid/slick.grid.js')}}">
    </script>
    <script language="javascript" type="text/javascript"
            src="{{ url_for('static', filename='js/bower_components/slickgrid/slick.formatters.js')}}">
    </script>
    <script language="javascript" type="text/javascript"
            src="{{ url_for('static', filename='js/bower_components/slickgrid/slick.editors.js')}}">
    </script>
    <script language="javascript" type="text/javascript"
            src="{{ url_for('static', filename='js/bower_components/slickgrid/plugins/slick.rowselectionmodel.js')}}">
    </script>
    <script language="javascript" type="text/javascript"
            src="{{ url_for('static', filename='js/bower_components/slickgrid/plugins/slick.rowmovemanager.js')}}">
    </script>

    <script language="javascript" type="text/javascript"
            src="{{ url_for('static', filename='js/recline.js')}}">
    </script>
    <script>
    var data = [
      {id: 0, date: '2011-01-01', x: 1, y: 2, z: 3, country: 'DE', geo: {lat:52.56, lon:13.40} },
      {id: 1, date: '2011-02-02', x: 2, y: 4, z: 24, country: 'UK', geo: {lat:54.97, lon:-1.60}},
      {id: 2, date: '2011-03-03', x: 3, y: 6, z: 9, country: 'US', geo: {lat:40.00, lon:-75.5}},
      {id: 3, date: '2011-04-04', x: 4, y: 8, z: 6, country: 'UK', geo: {lat:57.27, lon:-6.20}},
      {id: 4, date: '2011-05-04', x: 5, y: 10, z: 15, country: 'UK', geo: {lat:51.58, lon:0}},
      {id: 5, date: '2011-06-02', x: 6, y: 12, z: 18, country: 'DE', geo: {lat:51.04, lon:7.9}}
    ];

    var dataset = new recline.Model.Dataset({
        records: data
    });

    //Depending on the view, it may be important to set the date type
    dataset.fields.models[1].attributes.type = 'date';

    var $el = $('#mygrid');
    var grid = new recline.View.SlickGrid({
      model: dataset,
      el: $el
    });
    grid.visible = true;
    grid.render();
    </script>


{% endblock %}
